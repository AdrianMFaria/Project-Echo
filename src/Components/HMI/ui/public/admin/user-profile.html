<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>User Profile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style type="text/css">
      body {
        margin-top: 20px;
        color: #1a202c;
        text-align: left;
        background-color: #e2e8f0;
      }
      .main-body {
        padding: 15px;
      }
      .card {
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1),
          0 1px 2px 0 rgba(0, 0, 0, 0.06);
      }
      .card {
        position: relative;
        display: flex;
        flex-direction: column;
        min-width: 0;
        word-wrap: break-word;
        background-color: #fff;
        background-clip: border-box;
        border: 0 solid rgba(0, 0, 0, 0.125);
        border-radius: 0.25rem;
      }
      .card-body {
        flex: 1 1 auto;
        min-height: 1px;
        padding: 1rem;
      }
      .gutters-sm {
        margin-right: -8px;
        margin-left: -8px;
      }
      .gutters-sm > .col,
      .gutters-sm > [class*="col-"] {
        padding-right: 8px;
        padding-left: 8px;
      }
      .mb-3,
      .my-3 {
        margin-bottom: 1rem !important;
      }
      .bg-gray-300 {
        background-color: #e2e8f0;
      }
      .h-100 {
        height: 100% !important;
      }
      .shadow-none {
        box-shadow: none !important;
      }
    </style>
  </head>

  <body>
    <!-- <div id="user-info">
    <h1>User Account Information</h1>
    <p><strong>Username:</strong> <span id="username">JohnDoe</span></p>
    <p><strong>Email:</strong> <span id="email">johndoe@example.com</span></p></div>
    <div id="options">
    <h2>Options</h2>
    <button onclick="updatePassword()">Update Password</button>
    <button onclick="signOut()">Sign Out</button>
    <button onclick="deleteAccount()">Delete Account</button></div>
    -->
    <div class="container">
      <div class="main-body">
        <div class="row gutters-sm">
          <div class="col-md-4 mb-3">
            <div class="card">
              <div class="card-body">
                <div class="d-flex flex-column align-items-center text-center">
                  <img
                    src="./images/profile/user-1.jpg"
                    alt="Admin"
                    class="rounded-circle"
                    width="150"
                  />
                    <div class="mt-3">
                      <h4 id="user_name">Admin</h4>
                      <p class="text-secondary mb-1">Full Stack Developer</p>
                      <p class="text-muted font-size-sm">Email</p>
                      <button class="btn btn-primary" id="signOutButton">
                        Sign Out
                      </button>
                      <button class="btn btn-outline-primary" id="deleteAccButton">
                        Delete Account
                      </button>
                    </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-8">
            <div class="card mb-3">
              <div class="card-body">
                <div class="row"></div>
                <div class="row">
                  <div class="col-sm-3">
                    <h6 class="mb-0">Full Name</h6>
                  </div>
                  <div class="col-sm-9 text-secondary">Admin Admin</div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <h6 class="mb-0">Email</h6>
                  </div>
                  <div class="col-sm-9 text-secondary">Admin@deakin.cou.au</div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <h6 class="mb-0">Phone</h6>
                  </div>
                  <div class="col-sm-9 text-secondary">(03) 9244 6333</div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <h6 class="mb-0">Mobile</h6>
                  </div>
                  <div class="col-sm-9 text-secondary">(03) 9244 6333</div>
                </div>
                <hr />
                <div class="row">
                  <div class="col-sm-3">
                    <h6 class="mb-0">Reset Password</h6>
                  </div>
                  <div class="col-sm-9">
                    <div class="row">
                      <div class="col-sm-4">
                        <b>Old Password</b>
                      </div>
                      <input id="oldPassword" class="col-sm-5 text-secondary" type="text">
                      <div class="col-sm-4">
                        <b>New Password</b>
                      </div>
                      <input id="newPassword" class="col-sm-5 text-secondary" type="text">
                      <div class="col-sm-4">
                        <b>Confirm Password</b>
                      </div>
                      <input id="confirmPassword" class="col-sm-5 text-secondary" type="text">
                    </div>
                  </div>
                  <div class="col-md-auto">
                    <button class="btn btn-info" id="updatePassword">Update Password</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="row gutters-sm">
              <div class="col-sm-12 mb-3">
                <div class="card h-100">
                  <div class="card-body">
                    <h6 class="d-flex align-items-center mb-3">
                      <i class="material-icons text-info mr-2">Echo</i>Project
                      Status
                    </h6>
                    <small>Web Design</small>
                    <div class="progress mb-3" style="height: 5px">
                      <div
                        class="progress-bar bg-primary"
                        role="progressbar"
                        style="width: 80%"
                        aria-valuenow="80"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    <small>Website Markup</small>
                    <div class="progress mb-3" style="height: 5px">
                      <div
                        class="progress-bar bg-primary"
                        role="progressbar"
                        style="width: 72%"
                        aria-valuenow="72"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    <small>Engine Team</small>
                    <div class="progress mb-3" style="height: 5px">
                      <div
                        class="progress-bar bg-primary"
                        role="progressbar"
                        style="width: 89%"
                        aria-valuenow="89"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    <small>Server Setup</small>
                    <div class="progress mb-3" style="height: 5px">
                      <div
                        class="progress-bar bg-primary"
                        role="progressbar"
                        style="width: 55%"
                        aria-valuenow="55"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    <small>Backend API</small>
                    <div class="progress mb-3" style="height: 5px">
                      <div
                        class="progress-bar bg-primary"
                        role="progressbar"
                        style="width: 66%"
                        aria-valuenow="66"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script
      data-cfasync="false"
      src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"
    ></script>
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.bundle.min.js"></script>
    <!--
    <script type="text/javascript">
      function watchAction(options) {
        const { id, api, onSuccess, onError } = options;

        const el = document.querySelector(id);

        if (!el) {
          return;
        }

        el.addEventListener("click", async () => {
          try {
            const res = await fetch(api);

            if (!res.ok) {
              onError(new Error(res.statusText));
            }

            const data = await res.json();

            onSuccess(data);
          } catch (error) {
            onError(error);
          }
        });
      }

      watchAction({
        id: "#signOutButton",
        api: "/hmi/signout",
        onSuccess: () => {
          alert("logout successfully")
          console.log("Success");
        },
        onError: (error) => {
          console.error(error);
        },
      });

      watchAction({
        id: "#deleteAccButton",
        api: "/hmi/delete-account",
        onSuccess: () => {
          alert("delete successfully")
          console.log("Success");
        },
        onError: (error) => {
          console.error(error);
        },
      });
    </script>
    -->

    <script>
      $(document).ready(function() {
          $('#signOutButton').click(function() {
              // Make an AJAX request to logout endpoint
              $.ajax({
                  url: '/hmi/signout',
                  type: 'POST',
                  dataType: 'json',
                  success: function(response) {
                      // Check if logout was successful
                      if (response.success) {
                          // Redirect user to login page or perform any other action
                          window.location.href = 'welcome.html';
                      } else {
                          // Handle error, if any
                          alert('Logout failed. Please try again.');
                      }
                  },
                  error: function(xhr, status, error) {
                      // Handle AJAX error
                      console.error('AJAX Error:', status, error);
                  }
              });
          });

          $('#deleteAccButton').click(function() {
              // Make an AJAX request to logout endpoint
              $.ajax({
                  url: '/hmi/delete-account',
                  type: 'DELETE',
                  dataType: 'json',
                  success: function(response) {
                      // Check if logout was successful
                      if (response.success) {
                          // Redirect user to login page or perform any other action
                          window.location.href = 'welcome.html';
                      } else {
                          // Handle error, if any
                          alert('Delete Account\ failed. Please try again.');
                      }
                  },
                  error: function(xhr, status, error) {
                      // Handle AJAX error
                      console.error('AJAX Error:', status, error);
                  }
              });
          });

          $('#updatePassword').click(function() {

            var oldPassword = $('#oldPassword').val();
            var newPassword = $('#newPassword').val();
            var confirmPassword = $('#confirmPassword').val();

              // Make an AJAX request to update Password endpoint
              $.ajax({
                  url: '/hmi/ChangePassword',
                  type: 'POST',
                  dataType: 'json',
                  contentType: 'application/json',
                  data: JSON.stringify({
                      oldPassword: oldPassword,
                      newPassword: newPassword,
                      confirmPassword: confirmPassword
                  }),
                  success: function(response) {
                      if (response.success) {
                          alert("Password changed successfully")
                          window.location.href = 'welcome.html';
                      } else {
                          // Handle error, if any
                          alert('Update the password failed. Please try again.');
                      }
                  },
                  error: function(xhr, status, error) {
                      // Handle AJAX error
                      console.error('AJAX Error:', status, error);
                  }
              });
          });
      });
      </script>
  </body>
</html>
